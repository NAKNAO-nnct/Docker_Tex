\usepackage{url}        % url記述用
\usepackage{cite}       % bibTex用
% 余白設定
\usepackage[top=25truemm,bottom=25truemm,left=25truemm,right=25truemm]{geometry}
\setlength{\textwidth}{35zw}  % 1行の文字数35
% \usepackage{layout}       % 現在の\layoutを表示する
\kanjiskip=.1zw plus.5pt minus.5pt
% ページをまたぐ表用
\usepackage{longtable}
\setlength\LTcapwidth{\linewidth}

% 画像読み込み
\usepackage[dvipdfmx]{graphicx}
\usepackage{here}   % 画像の位置を記述位置にする

% 表のセルの縦結合
\usepackage{multirow}

% ソースコード記述用
\usepackage{listings}
\usepackage{jlisting} % 環境によってはないかも
\renewcommand{\lstlistingname}{図} %ソースコードも図として貼る
% listingsの番号をfigureに変更
\def\fnum@lstlisting{%
  \lstlistingname
  \ifx\lst@@caption\@empty\else~\thefigure\fi}
\lstset{%
  % language={C},%
  % basicstyle={\small},%
  % identifierstyle={\small},%
  % commentstyle={\small\itshape\color[rgb]{0,0.5,0}},%
  % keywordstyle={\small\bfseries\color[rgb]{0,0,1}},%
  % ndkeywordstyle={\small},%
  % stringstyle={\small\ttfamily\color[rgb]{1,0,1}},%
  frame=single,%
  breaklines=true,%
  columns=[l]{fullflexible},%
  % numbers=left,%
  xrightmargin=0zw,%
  xleftmargin=3zw,%
  numberstyle={\scriptsize},%
  stepnumber=1,%
  numbersep=1zw,%
  lineskip=-0.5ex,%
  keepspaces=true,%
  captionpos=b,%
  basicstyle=\ttfamily
}

\def\figuresize{0.8\textwidth}
\def\figureheight{0.8\textheight}

\renewcommand{\bibname}{参考文献}    % bibTexの章を書き換え
\newcommand*{\refdate}[1]{#1参照}   % 日付の参照

% chapterの再定義
% 上余白なし，下余白1
\def\@makechapterhead#1{\hbox{}%
  {\parindent\z@
   \raggedright
   \normalfont\Large\bfseries
   \leavevmode
   \ifnum \c@secnumdepth >\m@ne
     \setlength\@tempdima{\linewidth}%
     \setbox\z@\hbox{\@chapapp\thechapter\@chappos\hskip1zw}%
     \addtolength\@tempdima{-\wd\z@}%
     \unhbox\z@\nobreak
     \vtop{\hsize\@tempdima#1}%
   \else
     #1\relax
   \fi}\nobreak\vskip1\Cvs}
\def\@makeschapterhead#1{\hbox{}%
  {\parindent\z@
   \raggedright
   \normalfont\Large\bfseries
   \leavevmode
   \setlength\@tempdima{\linewidth}%
   \vtop{\hsize\@tempdima#1}}\vskip1\Cvs}

% sectionの再定義
% 上余白と下余白を調整
\renewcommand{\section}{\@startsection{section}{1}{\z@}%
   {.8\Cvs}%
   {.3\Cvs}%
   {\normalfont\bfseries}
}

\renewcommand{\subsection}{\@startsection{subsection}{1}{\z@}%
   {.8\Cvs}%
   {.3\Cvs}%
   {\normalfont\bfseries}
}

% 図入力簡易化マクロ
\newcommand{\myfigure}[3]{%
  \refstepcounter{lstlisting}
  \begin{figure}[H]%
    \centering%
    \includegraphics[width=\figuresize]{#1}%
    \caption{#2}%
    \label{#3}%
  \end{figure}%
}
\newcommand{\myfigureh}[3]{%
  \refstepcounter{lstlisting}
  \begin{figure}[H]%
    \centering%
    \includegraphics[height=\figureheight]{#1}%
    \caption{#2}%
    \label{#3}%
  \end{figure}%
}
% ソースコード入力簡易化マクロ
\newcommand{\mylistingD}[3]{
  \begin{figure}[H]
    \lstinputlisting{#1}
    \caption{#2}
    \label{#3}
  \end{figure}
}
% 上は非推奨下を使う
\newcommand{\mylisting}[3]{
  \vspace{8pt}
  \refstepcounter{figure}
  \lstinputlisting[caption=#2, label=#3]{#1}
}
\newcommand{\mylistingnum}[3]{
  \begin{center}
    \refstepcounter{figure}
    \vspace{8pt}
    \lstset{
      numbers=left
    }
    \lstinputlisting[caption=#2, label=#3]{#1}
  \end{center}
}

% 参照(図)
\newcommand{\reff}[1]{
  図\ref{#1}
}
% 参照(表)
\newcommand{\reft}[1]{
  表\ref{#1}
}

%%
%% タイトルページのレイアウト
%%
% サブタイトル
\gdef\@subtitle{}
\newcommand{\subtitle}[1]{
  \gdef\@subtitle{#1}
}
% 学年学科番号
\gdef\@grade{}
\newcommand{\grade}[1]{\gdef\@grade{#1}}
% 共同実験者
\gdef\@collaborator{}
\newcommand{\collaborator}[1]{\gdef\@collaborator{#1}}
% 提出日
\gdef\@submitdate{}
\newcommand{\submitdate}[1]{\gdef\@submitdate{#1}}
% 提出期限
\gdef\@submitlimit{}
\newcommand{\submitlimit}[1]{\gdef\@submitlimit{#1}}
% 実験日
\gdef\@expdate{}
\newcommand{\expdate}[1]{\gdef\@expdate{#1}}
% \maketitleの改変
\renewcommand{\maketitle}{\begin{titlepage}%
  \let\footnotesize\small
  \let\footnoterule\relax
  \let\footnote\thanks
  \null\vfil
  \vskip 60\p@
  \begin{center}%
    {\LARGE \@title \par}%
    \vskip 1.5em%
    {\Large \@subtitle \par}%
    \if\@expdate
    \else
    \vskip 5em%
    {\large 実験日 \par \@expdate \par}%
    \fi
    \if\@submitlimit
    \else
    \vskip 1em%
    {\large 提出期限:\@submitlimit \par}%
    \fi
    \if\@submitdate
    \else
    \vskip 1em%
    {\large 提出日:\@submitdate \par}%
    \fi
    \vskip 5em%
  \end{center}
  \begin{flushright}
    {\Large
    \@grade\par
     \lineskip .75em%
      \begin{tabular}[t]{c}%
        \@author
      \end{tabular}\par}%
      \vskip 1.5em%
    % {\large \@date \par}%       % Set date in \large size.
  \end{flushright}\par
  \if\@collaborator
  \else
  \vskip 4em%
  {\large 共同実験者: \par\@collaborator\par}%
  \fi
  \@thanks\vfil\null
  \end{titlepage}%
  \setcounter{footnote}{0}%
  \global\let\thanks\relax
  \global\let\maketitle\relax
  \global\let\p@thanks\relax
  \global\let\@thanks\@empty
  \global\let\@author\@empty
  \global\let\@date\@empty
  \global\let\@title\@empty
  \global\let\title\relax
  \global\let\author\relax
  \global\let\date\relax
  \global\let\and\relax
  }

\makeatletter
\def\mojiparline#1{
    \newcounter{mpl}
    \setcounter{mpl}{#1}
    \@tempdima=\linewidth
    \advance\@tempdima by-\value{mpl}zw
    \addtocounter{mpl}{-1}
    \divide\@tempdima by \value{mpl}
    \advance\kanjiskip by\@tempdima
    \advance\parindent by\@tempdima
}
\makeatother
\def\linesparpage#1{
    \baselineskip=\textheight
    \divide\baselineskip by #1
}